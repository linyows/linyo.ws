<!DOCTYPE html><html n-head=""n-head-ssr><meta n-head="true"charset="utf-8"><meta n-head="true"content="width=device-width,initial-scale=1"name="viewport"><meta n-head="true"content="Nuxt.js project"name="description"hid="description"><title n-head="true">linyows</title><link href="/favicon.ico"rel="icon"n-head="true"type="image/x-icon"><link href="/_nuxt/style.css"rel="stylesheet"><body n-head=""><div id="__nuxt"server-rendered="true"><div class="progress"data-v-71b3a807 style="width:0;height:2px;background-color:#000;opacity:0"></div><div class="body"><section class="container"data-v-68ed63e4><h1 data-v-68ed63e4>OCTOPASS</h1><p data-v-68ed63e4 class="description">Management linux user and authentication with the organization/team on Github<div class="content"data-v-68ed63e4><h2 data-v-68ed63e4>Description</h2><p data-v-68ed63e4>This is linux user management tool with the organization/team on github, and authentication. Depending on github for user management, there are certain risks, but features easy handling and ease of operation.<h2 data-v-68ed63e4>Usage</h2><p data-v-68ed63e4 class="img-right"><img alt="Github Org/Team"data-v-68ed63e4 src="https://github.com/linyows/octopass/blob/master/misc/github-org-team.png?raw=true"width="500"><p data-v-68ed63e4>For example, adding "Ken" to a team with github organization ...<p data-v-68ed63e4>Octopass is a valid linux server, Ken will be able to ssh login with the key registered in github.<p data-v-68ed63e4>Wow!?<p data-v-68ed63e4>By octopass name resolution, you can check the id of team members of github organization.<pre data-v-68ed63e4><code data-v-68ed63e4>
    $ id ken
    uid=5458(ken) gid=2000(operators) groups=2000(operators)
    </code></pre><p data-v-68ed63e4>You can also see a list like `/etc/passwd,shadow,group` by the `octopass`. For detail `--help`.<pre data-v-68ed63e4><code data-v-68ed63e4>
    $ octopass passwd
    chun-li:x:14301:2000:managed by octopass:/home/chun-li:/bin/bash
    dhalsim:x:8875:2000:managed by octopass:/home/dhalsim:/bin/bash
    ken:x:5458:2000:managed by octopass:/home/ken:/bin/bash
    ryu:x:74049:2000:managed by octopass:/home/ryu:/bin/bash
    sagat:x:93011:2000:managed by octopass:/home/sagat:/bin/bash
    zangief:x:8305:2000:managed by octopass:/home/zangief:/bin/bash
    </code></pre><p data-v-68ed63e4>And octopass gets the public key from github for key authentication.<pre data-v-68ed63e4><code data-v-68ed63e4>
    $ octopass ken
    ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqUJvs1vRgHRMH9dpxYcBBV687njS2YrJ+oeIKvbAbg6yL4QsJMeElcPOlmfWEYsp8vbRLXQCTvv14XJfKmgp8V9es5P/l8r5Came3X1S/muqRMONUTdygCpfyo+BJGIMVKtH8fSsBCWfJJ1EYEesyzxqc2u44yIiczM2b461tRwW+7cHNrQ6bKEY9sRMV0p/zkOdPwle30qQml+AlS1SvbrMiiJLEW75dSSENr5M+P4ciJHYXhsrgLE95+ThFPqbznZYWixxATWEYMLiK6OrSy5aYss4o9mvEBJozyrVdKyKz11zSK2D4Z/JTh8eP+NxAw5otqBmfNx+HhKRH3MhJQ==
    </code></pre><h2 data-v-68ed63e4>Why?</h2><p data-v-68ed63e4>I did not need functions like ldap, and asked for ease and ease of introduction. Therefore, the user only considers it as administrator authority. However, it is very easy to add a newly added user or to remove a user who leaves.<p data-v-68ed63e4>Also, in order to speedily resolve names, Github API responses are file cached. With this, even if Github is down, it will work if past caches remain.<h3 data-v-68ed63e4>Architecture</h3><p data-v-68ed63e4 class="img-center"><img alt="Architecture"data-v-68ed63e4 src="https://github.com/linyows/octopass/blob/master/misc/architecture.png?raw=true"width="600"><h2 data-v-68ed63e4>Installation</h2><p data-v-68ed63e4>Packages are provided via <a data-v-68ed63e4 href="https://packagecloud.io/linyows/octopass">packagecloud</a>.<p data-v-68ed63e4>Available for:<ul data-v-68ed63e4><li data-v-68ed63e4>CentOS 7.x<li data-v-68ed63e4>CentOS 6.x<li data-v-68ed63e4>CentOS 5.x<li data-v-68ed63e4>Ubuntu Xenial<li data-v-68ed63e4>Ubuntu Trusty<li data-v-68ed63e4>Ubuntu Precise</ul><h3 data-v-68ed63e4>Building from Source</h3><p data-v-68ed63e4>Dependency<ul data-v-68ed63e4><li data-v-68ed63e4>glibc<li data-v-68ed63e4>libcurl<li data-v-68ed63e4>jansson</ul><pre data-v-68ed63e4><code data-v-68ed63e4>
    $ git clone https://github.com/linyows/octopass
    $ make && make install
    $ mv octopass.conf.example /etc/octopass.conf
    </code></pre><h2 data-v-68ed63e4>Configuration</h2><p data-v-68ed63e4>Edit octopass.conf:<pre data-v-68ed63e4><code data-v-68ed63e4>
    $ mv /etc/{octopass.conf.example,octopass.conf}
    </code></pre><p data-v-68ed63e4>Generate token from here: https://github.com/settings/tokens/new. Need: Read org and team membership<h3 data-v-68ed63e4>SSHD Configuration</h3><p data-v-68ed63e4>/etc/ssh/sshd_config:<pre data-v-68ed63e4><code data-v-68ed63e4>
    AuthorizedKeysCommand /usr/bin/octopass
    AuthorizedKeysCommandUser root
    UsePAM yes
    PasswordAuthentication no
    </code></pre><h3 data-v-68ed63e4>PAM Configuration</h3><h4 data-v-68ed63e4>Ubuntu</h4><p data-v-68ed63e4>/etc/pam.d/sshd:<pre data-v-68ed63e4><code data-v-68ed63e4>
    #@include common-auth
    auth requisite pam_exec.so quiet expose_authtok /usr/bin/octopass pam
    auth optional pam_unix.so not_set_pass use_first_pass nodelay
    session required pam_mkhomedir.so skel=/etc/skel/ umask=0022
    </code></pre><h4 data-v-68ed63e4>CentOS</h4><p data-v-68ed63e4>/etc/pam.d/system-auth-ac:<pre data-v-68ed63e4><code data-v-68ed63e4>
    # auth        sufficient    pam_unix.so nullok try_first_pass
    auth requisite pam_exec.so quiet expose_authtok /usr/bin/octopass pam
    auth optional pam_unix.so not_set_pass use_first_pass nodelay
    </code></pre><p data-v-68ed63e4>/etc/pam.d/sshd:<pre data-v-68ed63e4><code data-v-68ed63e4>
    session required pam_mkhomedir.so skel=/etc/skel/ umask=0022
    </code></pre><h3 data-v-68ed63e4>NSS Switch Configuration</h3><p data-v-68ed63e4>/etc/nsswitch.conf:<pre data-v-68ed63e4><code data-v-68ed63e4>
    passwd:     files octopass sss
    shadow:     files octopass sss
    group:      files octopass sss
    </code></pre><p data-v-68ed63e4>Enable octopass as name resolution.</div><a data-v-68ed63e4 href="/"class="button nuxt-link-active">linyows</a></section><footer>Copyright Â© 2017 linyo.ws All right reserved.</footer></div></div><script defer>window.__NUXT__={data:[null],error:null,serverRendered:!0}</script><script defer src="/_nuxt/vendor.bundle.js"></script><script defer src="/_nuxt/nuxt.bundle.js"></script>